textview,
sourceview {
    background-color: @lumina_card;
    color: @lumina_text;

    /* Superficie editorial cómoda */
    border-radius: 0.75em;
    padding: 1em;

    caret-color: @lumina_primary;

    box-shadow:
        0 0.0625em 0.125em alpha(black, 0.08),
        0 0.375em 0.75em alpha(black, 0.06);

    transition:
        box-shadow 200ms ease,
        background-color 200ms ease;
}

/* Foco activo: claridad, no dramatismo */
textview:focus,
sourceview:focus {
    box-shadow:
        0 0.0625em 0.125em alpha(black, 0.12),
        0 0.5em 1.25em alpha(black, 0.10);
}

/* Fondo interno real */
textview text,
sourceview text {
    background-color: transparent;
}

/* ============================================================
   SELECCIÓN DE TEXTO
   ============================================================ */

textview text selection,
sourceview text selection {
    background-color: alpha(@lumina_primary, 0.26);
    color: @lumina_text;
    border-radius: 0.125em;
}

/* Selección sin foco */
textview:backdrop text selection,
sourceview:backdrop text selection {
    background-color: alpha(@lumina_primary, 0.16);
}

/* ============================================================
   CARET
   ============================================================ */

textview text cursor,
sourceview text cursor {
    background-color: @lumina_primary;
}

/* ============================================================
   HIGHLIGHTS / SEARCH
   ============================================================ */

textview text highlight,
sourceview text highlight {
    background-color: alpha(@lumina_warning, 0.32);
    color: @lumina_text;
}

textview text highlight:selected,
sourceview text highlight:selected {
    background-color: alpha(@lumina_primary, 0.42);
}

/* ============================================================
   CURRENT LINE (CODE EDITORS)
   ============================================================ */

/* Selección general */
sourceview text:selected {
    background-color: alpha(@lumina_primary, 0.15);
}

/* Línea activa */
sourceview text line:selected {
    background-color: alpha(@lumina_primary, 0.06);
}

/* ============================================================
   GUTTER / LINE NUMBERS
   ============================================================ */

.sourceview gutter {
    background-color: alpha(@lumina_surface, 0.88);
    color: @lumina_text_secondary;

    padding: 0.375em 0.5em;
    border-right: 0.0625em solid alpha(@lumina_outline, 0.6);
}

/* Línea actual en gutter */
.sourceview gutter:selected {
    color: @lumina_primary;
    background-color: alpha(@lumina_primary, 0.08);
}

/* ============================================================
   SCROLLBARS (EDITOR CONTEXT)
   ============================================================ */

textview scrollbar,
sourceview scrollbar {
    background-color: transparent;
}

textview scrollbar slider,
sourceview scrollbar slider {
    border-radius: 0.5em;
    background-color: alpha(@lumina_text, 0.25);
}

textview scrollbar slider:hover,
sourceview scrollbar slider:hover {
    background-color: alpha(@lumina_primary, 0.45);
}

/* ============================================================
   BACKDROP (SIN FOCO)
   ============================================================ */

textview:backdrop,
sourceview:backdrop {
    background-color: alpha(@lumina_card, 0.72);
    color: @lumina_text_secondary;

    box-shadow:
        0 0.0625em 0.125em alpha(black, 0.04);
}

/* ============================================================
   READ-ONLY / DISABLED
   ============================================================ */

textview:disabled,
sourceview:disabled {
    background-color: @lumina_surface;
    color: alpha(@lumina_text, 0.55);
    box-shadow: none;
}

/* Línea actual sin selección */
sourceview text line {
    background-color: transparent;
}

sourceview text line:focus {
    background-color: alpha(@lumina_primary, 0.04);
}

/* Paréntesis emparejados */
sourceview text bracket-match {
    background-color: alpha(@lumina_primary, 0.18);
    color: @lumina_text;
    border-radius: 0.125em;
}

/* Errores y advertencias */
sourceview text.error {
    text-decoration: underline;
    text-decoration-color: @lumina_error;
}

sourceview text.warning {
    text-decoration: underline;
    text-decoration-color: @lumina_warning;
}

/* Tokens básicos */
sourceview text.comment {
    color: alpha(@lumina_text_secondary, 0.85);
    font-style: italic;
}

sourceview text.keyword {
    color: @lumina_primary;
    font-weight: 600;
}

sourceview text selection {
    box-shadow: inset 0.1875em 0 0 alpha(@lumina_primary, 0.6);
}

textview text.placeholder,
sourceview text.placeholder {
    color: alpha(@lumina_text_secondary, 0.6);
}

